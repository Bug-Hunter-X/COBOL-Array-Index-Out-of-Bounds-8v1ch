01  WS-DATA-AREA. 
    05  WS-COUNTER PIC 9(5) VALUE 0. 
    05  WS-ARRAY OCCURS 100 TIMES INDEXED BY WS-INDEX. 
       10  WS-ARRAY-ELEMENT PIC X(50). 

PROCEDURE DIVISION. 
    PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > 100 
       MOVE "VALUE" & WS-INDEX TO WS-ARRAY-ELEMENT(WS-INDEX) 
       ADD 1 TO WS-COUNTER 
    END-PERFORM. 
    DISPLAY "Counter value: " WS-COUNTER 
    STOP RUN.